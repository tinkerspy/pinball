#pragma once

/* Custom firmware for the Atm_device programmable pinball device class
 *  
 *  tictactoe
 *  
 *  playfield.device( <switch-id> ); // Instantiates object
 *  playfield.device( <switch-id>, <led-id>, <firmware> ); // Initializes object
 *  
 */

namespace custom_firmware {

enum { IN_ANI_INIT, IN_ANI_CYCLE };
enum { ARG_LED0, ARG_LED1, ARG_LED2 }; 

int16_t animation_firmware[] = {
  IN_ANI_INIT, 
  IN_ANI_CYCLE,
  -1,

  IN_ANI_INIT,
  'P', -1, -1, 1,  // Persistent
  'H', -1, -1, ARG_LED0,
  'L', -1, -1, ARG_LED1,
  'L', -1, -1, ARG_LED2,
  -1,

  IN_ANI_CYCLE,
  'L', -1, -1, ARG_LED0, 
  'H', -1, -1, ARG_LED1, 
  'Y', -1, -1, 0,
  'L', -1, -1, ARG_LED1, 
  'H', -1, -1, ARG_LED2, 
  'Y', -1, -1, 0,
  'L', -1, -1, ARG_LED2, 
  'H', -1, -1, ARG_LED0, 
  'Y', -1, -1, 0,
  'L', -1, -1, ARG_LED0, 
  'H', -1, -1, ARG_LED1, 
  'Y', -1, -1, 0,
  'L', -1, -1, ARG_LED1, 
  'H', -1, -1, ARG_LED2, 
  'Y', -1, -1, 0,
  'L', -1, -1, ARG_LED2, 
  'H', -1, -1, ARG_LED0, 
  'Y', -1, -1, 0,
  'A', -1, -1, IN_ANI_CYCLE,
  -1,

  -1,
};


// Williams OXO tic-tac-toe game

enum { // Inputs & Subs
  IN_OXO_INIT,
  IN_OXO_1O, IN_OXO_1X, IN_OXO_2O, IN_OXO_2X, IN_OXO_3O, IN_OXO_3X,             
  IN_OXO_4, IN_OXO_5, IN_OXO_6, IN_OXO_7, IN_OXO_8, IN_OXO_9, 
  IN_OXO_TOGGLE, IN_OXO_COLLECT, IN_OXO_SINGLE, IN_OXO_TRIPLE,
  SUB_OXO_COLLECT, 
  SUB_OXO_MATCH_123, SUB_OXO_MATCH_456, SUB_OXO_MATCH_789,
  SUB_OXO_MATCH_147, SUB_OXO_MATCH_258, SUB_OXO_MATCH_369,
  SUB_OXO_MATCH_159, SUB_OXO_MATCH_357, 
  SUB_OXO_MATCH_ALL,
  SUB_OXO_CLEAR,
};

enum { OUT_OXO_SCORE, OUT_OXO_WIN_ROW, OUT_OXO_WIN_ALL, OUT_OXO_COLLECT }; // Outputs

enum { // Arguments (leds)
  ARG_OXO_1A, ARG_OXO_1B, ARG_OXO_1C, 
  ARG_OXO_2A, ARG_OXO_2B, ARG_OXO_2C,
  ARG_OXO_3A, ARG_OXO_3B, ARG_OXO_3C,
  ARG_OXO_4A, ARG_OXO_4B, ARG_OXO_4C,
  ARG_OXO_5A, ARG_OXO_5B, ARG_OXO_5C,
  ARG_OXO_6A, ARG_OXO_6B, ARG_OXO_6C,
  ARG_OXO_7A, ARG_OXO_7B, ARG_OXO_7C,
  ARG_OXO_8A, ARG_OXO_8B, ARG_OXO_8C,
  ARG_OXO_9A, ARG_OXO_9B, ARG_OXO_9C,
  ARG_OXO_X, ARG_OXO_O, ARG_OXO_TRIPLE,
};

int16_t tictactoe_firmware[] = {
  IN_OXO_INIT,
  IN_OXO_1O, IN_OXO_1X, IN_OXO_2O, IN_OXO_2X, IN_OXO_3O, IN_OXO_3X,             
  IN_OXO_4, IN_OXO_5, IN_OXO_6, IN_OXO_7, IN_OXO_8, IN_OXO_9, 
  IN_OXO_TOGGLE, IN_OXO_COLLECT, IN_OXO_SINGLE, IN_OXO_TRIPLE,
  SUB_OXO_COLLECT, 
  SUB_OXO_MATCH_123, SUB_OXO_MATCH_456, SUB_OXO_MATCH_789,
  SUB_OXO_MATCH_147, SUB_OXO_MATCH_258, SUB_OXO_MATCH_369,
  SUB_OXO_MATCH_159, SUB_OXO_MATCH_357, 
  SUB_OXO_MATCH_ALL,
  SUB_OXO_CLEAR,
  -1,

  IN_OXO_INIT,
  'P', -1, -1, 1,
//'P', -1, -1, 1 << IN_OXO_COLLECT,
//'Q', -1, -1, 1 << OUT_OXO_COLLECT,
  'S', -1, -1, SUB_OXO_CLEAR,
  -1,

  IN_OXO_1O, 
  'J', ARG_OXO_1A, -1, 0, 
  'J', ARG_OXO_1B, -1, 0, 
  'H', -1, -1, ARG_OXO_1A, 
  'H', -1, -1, ARG_OXO_1C, 
  'S', -1, -1, SUB_OXO_MATCH_123,
  'S', -1, -1, SUB_OXO_MATCH_147,
  'S', -1, -1, SUB_OXO_MATCH_159,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_1X, 
  'J', ARG_OXO_1A, -1, 0, 
  'J', ARG_OXO_1B, -1, 0, 
  'H', -1, -1, ARG_OXO_1B, 
  'S', -1, -1, SUB_OXO_MATCH_123,
  'S', -1, -1, SUB_OXO_MATCH_147,
  'S', -1, -1, SUB_OXO_MATCH_159,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_2O, 
  'J', ARG_OXO_2A, -1, 0, 
  'J', ARG_OXO_2B, -1, 0, 
  'H', -1, -1, ARG_OXO_2A, 
  'H', -1, -1, ARG_OXO_2C, 
  'S', -1, -1, SUB_OXO_MATCH_123,
  'S', -1, -1, SUB_OXO_MATCH_258,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_2X, 
  'J', ARG_OXO_2A, -1, 0, 
  'J', ARG_OXO_2B, -1, 0, 
  'H', -1, -1, ARG_OXO_2B, 
  'S', -1, -1, SUB_OXO_MATCH_123,
  'S', -1, -1, SUB_OXO_MATCH_258,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_3O, 
  'J', ARG_OXO_3A, -1, 0, 
  'J', ARG_OXO_3B, -1, 0, 
  'H', -1, -1, ARG_OXO_3A, 
  'H', -1, -1, ARG_OXO_3C, 
  'S', -1, -1, SUB_OXO_MATCH_123,
  'S', -1, -1, SUB_OXO_MATCH_369,
  'S', -1, -1, SUB_OXO_MATCH_357,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_3X, 
  'J', ARG_OXO_3A, -1, 0, 
  'J', ARG_OXO_3B, -1, 0, 
  'H', -1, -1, ARG_OXO_3B, 
  'S', -1, -1, SUB_OXO_MATCH_123,
  'S', -1, -1, SUB_OXO_MATCH_369,
  'S', -1, -1, SUB_OXO_MATCH_357,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,

  IN_OXO_4, 
  'J', ARG_OXO_4A, -1, 0, 
  'J', ARG_OXO_4B, -1, 0, 
  'H', ARG_OXO_X, ARG_OXO_4B, ARG_OXO_4A, 
  'H', ARG_OXO_X, ARG_OXO_4B, ARG_OXO_4C, 
  'S', -1, -1, SUB_OXO_MATCH_147,
  'S', -1, -1, SUB_OXO_MATCH_456,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_5, 
  'J', ARG_OXO_5A, -1, 0, 
  'J', ARG_OXO_5B, -1, 0, 
  'H', ARG_OXO_X, ARG_OXO_5B, ARG_OXO_5A, 
  'H', ARG_OXO_X, ARG_OXO_5B, ARG_OXO_5C, 
  'S', -1, -1, SUB_OXO_MATCH_159,
  'S', -1, -1, SUB_OXO_MATCH_258,
  'S', -1, -1, SUB_OXO_MATCH_357,
  'S', -1, -1, SUB_OXO_MATCH_456,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_6, 
  'J', ARG_OXO_6A, -1, 0, 
  'J', ARG_OXO_6B, -1, 0, 
  'H', ARG_OXO_X, ARG_OXO_6B, ARG_OXO_6A, 
  'H', ARG_OXO_X, ARG_OXO_6B, ARG_OXO_6C, 
  'S', -1, -1, SUB_OXO_MATCH_369,
  'S', -1, -1, SUB_OXO_MATCH_456,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_7, 
  'J', ARG_OXO_7A, -1, 0, 
  'J', ARG_OXO_7B, -1, 0, 
  'H', ARG_OXO_X, ARG_OXO_7B, ARG_OXO_7A, 
  'H', ARG_OXO_X, ARG_OXO_7B, ARG_OXO_7C, 
  'S', -1, -1, SUB_OXO_MATCH_789,
  'S', -1, -1, SUB_OXO_MATCH_147,
  'S', -1, -1, SUB_OXO_MATCH_357,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_8, 
  'J', ARG_OXO_8A, -1, 0, 
  'J', ARG_OXO_8B, -1, 0, 
  'H', ARG_OXO_X, ARG_OXO_8B, ARG_OXO_8A, 
  'H', ARG_OXO_X, ARG_OXO_8B, ARG_OXO_8C, 
  'S', -1, -1, SUB_OXO_MATCH_258,
  'S', -1, -1, SUB_OXO_MATCH_789,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,
  
  IN_OXO_9, 
  'J', ARG_OXO_9A, -1, 0, 
  'J', ARG_OXO_9B, -1, 0, 
  'H', ARG_OXO_X, ARG_OXO_9B, ARG_OXO_9A, 
  'H', ARG_OXO_X, ARG_OXO_9B, ARG_OXO_9C, 
  'S', -1, -1, SUB_OXO_MATCH_159,
  'S', -1, -1, SUB_OXO_MATCH_369,
  'S', -1, -1, SUB_OXO_MATCH_789,
  'S', -1, -1, SUB_OXO_MATCH_ALL,
  -1,

  IN_OXO_TOGGLE, 
  'J', ARG_OXO_X, 0, 3, 
  'L', -1, -1, ARG_OXO_X, 
  'H', -1, -1, ARG_OXO_O, 
  'J', -1, -1, -1, 
  'L', -1, -1, ARG_OXO_O, 
  'H', -1, -1, ARG_OXO_X, 
  -1,

  IN_OXO_SINGLE,
  'L', -1, -1, ARG_OXO_TRIPLE,
  -1,

  IN_OXO_TRIPLE,
  'H', -1, -1, ARG_OXO_TRIPLE,
  -1,

  IN_OXO_COLLECT,
  'S', -1, -1, SUB_OXO_COLLECT,    
  'J', ARG_OXO_TRIPLE, 0, 4,
  'Y', -1, -1, 1000,
  'S', -1, -1, SUB_OXO_COLLECT,    
  'Y', -1, -1, 1000,
  'S', -1, -1, SUB_OXO_COLLECT,    
  'I', -1, -1, -1,
  'S', -1, -1, SUB_OXO_CLEAR,
  -1,

  SUB_OXO_MATCH_123,
  'J', ARG_OXO_1A, 0,  2,
  'J', ARG_OXO_2A, 0, -1,
  'J', ARG_OXO_3A, 3, -1,
  'J', ARG_OXO_1B, 0, -1,
  'J', ARG_OXO_2B, 0, -1,
  'J', ARG_OXO_3B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,
  
  SUB_OXO_MATCH_456,
  'J', ARG_OXO_4A, 0,  2,
  'J', ARG_OXO_5A, 0, -1,
  'J', ARG_OXO_6A, 3, -1,
  'J', ARG_OXO_4B, 0, -1,
  'J', ARG_OXO_5B, 0, -1,
  'J', ARG_OXO_6B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,

  SUB_OXO_MATCH_789,
  'J', ARG_OXO_7A, 0,  2,
  'J', ARG_OXO_8A, 0, -1,
  'J', ARG_OXO_9A, 3, -1,
  'J', ARG_OXO_7B, 0, -1,
  'J', ARG_OXO_8B, 0, -1,
  'J', ARG_OXO_9B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,

  SUB_OXO_MATCH_147, 
  'J', ARG_OXO_1A, 0,  2,
  'J', ARG_OXO_4A, 0, -1,
  'J', ARG_OXO_7A, 3, -1,
  'J', ARG_OXO_1B, 0, -1,
  'J', ARG_OXO_4B, 0, -1,
  'J', ARG_OXO_7B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,
  
  SUB_OXO_MATCH_258, 
  'J', ARG_OXO_2A, 0,  2,
  'J', ARG_OXO_5A, 0, -1,
  'J', ARG_OXO_8A, 3, -1,
  'J', ARG_OXO_2B, 0, -1,
  'J', ARG_OXO_5B, 0, -1,
  'J', ARG_OXO_8B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,
  
  SUB_OXO_MATCH_369,
  'J', ARG_OXO_3A, 0,  2,
  'J', ARG_OXO_6A, 0, -1,
  'J', ARG_OXO_9A, 3, -1,
  'J', ARG_OXO_3B, 0, -1,
  'J', ARG_OXO_6B, 0, -1,
  'J', ARG_OXO_9B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,
  
  SUB_OXO_MATCH_159, 
  'J', ARG_OXO_1A, 0,  2,
  'J', ARG_OXO_5A, 0, -1,
  'J', ARG_OXO_9A, 3, -1,
  'J', ARG_OXO_1B, 0, -1,
  'J', ARG_OXO_5B, 0, -1,
  'J', ARG_OXO_9B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,
  
  SUB_OXO_MATCH_357,
  'J', ARG_OXO_3A, 0,  2,
  'J', ARG_OXO_5A, 0, -1,
  'J', ARG_OXO_7A, 3, -1,
  'J', ARG_OXO_3B, 0, -1,
  'J', ARG_OXO_5B, 0, -1,
  'J', ARG_OXO_7B, 0, -1,
  'T', -1, -1, OUT_OXO_WIN_ROW,
  -1,

  SUB_OXO_MATCH_ALL,
  'T', -1, -1, OUT_OXO_SCORE, 
  'I', -1, -1, -1,
  'I', ARG_OXO_1A, 1, 0,
  'I', ARG_OXO_2A, 1, 0,
  'I', ARG_OXO_3A, 1, 0,
  'I', ARG_OXO_4A, 1, 0,
  'I', ARG_OXO_5A, 1, 0,
  'I', ARG_OXO_6A, 1, 0,
  'I', ARG_OXO_7A, 1, 0,
  'I', ARG_OXO_8A, 1, 0,
  'I', ARG_OXO_9A, 1, 0,
  'I', ARG_OXO_1B, 1, 0,
  'I', ARG_OXO_2B, 1, 0,
  'I', ARG_OXO_3B, 1, 0,
  'I', ARG_OXO_4B, 1, 0,
  'I', ARG_OXO_5B, 1, 0,
  'I', ARG_OXO_6B, 1, 0,
  'I', ARG_OXO_7B, 1, 0,
  'I', ARG_OXO_8B, 1, 0,
  'I', ARG_OXO_9B, 1, 0,
  'T', 9, OUT_OXO_WIN_ALL, -1,
  -1,
    
  SUB_OXO_CLEAR,
  'L', -1, -1, ARG_OXO_1A,
  'L', -1, -1, ARG_OXO_1B,
  'L', -1, -1, ARG_OXO_1C,
  'L', -1, -1, ARG_OXO_2A,
  'L', -1, -1, ARG_OXO_2B,
  'L', -1, -1, ARG_OXO_2C,
  'L', -1, -1, ARG_OXO_3A,
  'L', -1, -1, ARG_OXO_3B,
  'L', -1, -1, ARG_OXO_3C,
  'L', -1, -1, ARG_OXO_4A,
  'L', -1, -1, ARG_OXO_4B,
  'L', -1, -1, ARG_OXO_4C,
  'L', -1, -1, ARG_OXO_5A,
  'L', -1, -1, ARG_OXO_5B,
  'L', -1, -1, ARG_OXO_5C,
  'L', -1, -1, ARG_OXO_6A,
  'L', -1, -1, ARG_OXO_6B,
  'L', -1, -1, ARG_OXO_6C,
  'L', -1, -1, ARG_OXO_7A,
  'L', -1, -1, ARG_OXO_7B,
  'L', -1, -1, ARG_OXO_7C,
  'L', -1, -1, ARG_OXO_8A,
  'L', -1, -1, ARG_OXO_8B,
  'L', -1, -1, ARG_OXO_8C,
  'L', -1, -1, ARG_OXO_9A,
  'L', -1, -1, ARG_OXO_9B,
  'L', -1, -1, ARG_OXO_9C,
  'L', -1, -1, ARG_OXO_X,
  'H', -1, -1, ARG_OXO_O,  
  'L', -1, -1, ARG_OXO_TRIPLE,  
  -1,
    
  SUB_OXO_COLLECT,
  'J', ARG_OXO_1A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_1A,
  'L', -1, -1, ARG_OXO_1C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_1A,
  'H', -1, -1, ARG_OXO_1C,
  'J', ARG_OXO_1B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_1B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_1B,
  'J', ARG_OXO_2A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_2A,
  'L', -1, -1, ARG_OXO_2C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_2A,
  'H', -1, -1, ARG_OXO_2C,
  'J', ARG_OXO_2B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_2B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_2B,
  'J', ARG_OXO_3A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_3A,
  'L', -1, -1, ARG_OXO_3C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_3A,
  'H', -1, -1, ARG_OXO_3C,
  'J', ARG_OXO_3B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_3B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_3B,
  'J', ARG_OXO_4A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_4A,
  'L', -1, -1, ARG_OXO_4C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_4A,
  'H', -1, -1, ARG_OXO_4C,
  'J', ARG_OXO_4B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_4B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_4B,
  'J', ARG_OXO_5A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_5A,
  'L', -1, -1, ARG_OXO_5C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_5A,
  'H', -1, -1, ARG_OXO_5C,
  'J', ARG_OXO_5B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_5B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_5B,
  'J', ARG_OXO_6A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_6A,
  'L', -1, -1, ARG_OXO_6C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_6A,
  'H', -1, -1, ARG_OXO_6C,
  'J', ARG_OXO_6B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_6B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_6B,
  'J', ARG_OXO_7A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_7A,
  'L', -1, -1, ARG_OXO_7C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_7A,
  'H', -1, -1, ARG_OXO_7C,
  'J', ARG_OXO_7B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_7B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_7B,
  'J', ARG_OXO_8A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_8A,
  'L', -1, -1, ARG_OXO_8C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_8A,
  'H', -1, -1, ARG_OXO_8C,
  'J', ARG_OXO_8B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_8B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_8B,
  'J', ARG_OXO_9A, 0, 6,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_9A,
  'L', -1, -1, ARG_OXO_9C,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_9A,
  'H', -1, -1, ARG_OXO_9C,
  'J', ARG_OXO_9B, 0, 4,
  'T', -1, -1, OUT_OXO_COLLECT,
  'L', -1, -1, ARG_OXO_9B,
  'Y', -1, -1, 500,
  'H', -1, -1, ARG_OXO_9B,
  -1,  

  -1,
};      

};
